<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head'); %>
</head>
<body>

<header>
  <%- include('../partials/header'); %>
</header>

<main>
  <div class="grid-container" style="grid-template-columns: 50% 50%;">
    <div class="grid-item">
      <div class="all-cards-title">
        <h2 style="text-align: center;">All Cards</h2>
      </div>
      
      <table class="card-gallery-table" id="card-gallery-table">
        <thead>
          <tr>
            <th>
              Name
              <span class="sortby" onclick="sortTable(0, 'card-gallery-table')" id="0">
                &#x25BC;
              </span>
            </th>
            <th>
              Card Type
              <span class="sortby" onclick="sortTable(1, 'card-gallery-table')" id="1">
                &#x25BC;
              </span>
            </th>
            <th>
              Info
            </th>
            <th>
              Add to Deck
            </th>
          </tr>
        </thead>
        <tbody>
          <% for (let i = 0; i < locals.cards.length; i++) { %>
            <tr id=<%=`drag${i}` %> draggable="true" ondragstart="drag(event)" class="card-gallery-row">
              <td>
                <div>
                  <a href="<%= '/card/' + locals.cards[i].id %>" draggable="true" ondragstart="drag(event)" class="card-gallery-link">
                    <%= locals.cards[i].name %>
                  </a>
                </div>
              </td>
              <td>
                <div>
                  <a href="<%= '/card/' + locals.cards[i].id %>" draggable="true" ondragstart="drag(event)" class="card-gallery-link">
                    <%= locals.cards[i].cardtype %>
                  </a>
                </div>
              </td>
              <td>
                <div class="<%= 'card-info | for-' + locals.cards[i].name %>">
                  ðŸ’¬
                </div>
                <div class="<%= 'card-tooltip | for-' + locals.cards[i].name %>">
                  <img 
                    src=<%= locals.cards[i].image_url %> 
                    class="card-image-tooltip" 
                    alt=<%= locals.cards[i].name %>
                    onerror="imageErrorHandler(this)"
                    >
                  </img>
                  <div class="cardinfo-small">
                    <%- include('../partials/cardinfo', { card: locals.cards[i] }); %>
                  </div>
                </div>
              </td>
              <td class="add-deck" onclick="addToDeck(event)">
                  âž•
              </td>
            </tr>
          <% } %>
        </tbody>
      </table>

    </div>

    <div class="grid-item">
      <h2 style="text-align: center;">My Deck</h2>

      <h2 style="text-align: left;">Leader</h2>

      <div class="leader-container" id="leader-container" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div class="drag-zone">
          &#10133
        </div>
        <table class="card-gallery-table", id="leader-container-table">
          <tbody></tbody>
        </table>
      </div>

      <h2 style="text-align: left;">Deck</h2>

      <div class="deck-container" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div class="drag-zone">
          &#10133
        </div>
        <table class="card-gallery-table", id="my-deck-table">
          <thead>
            <tr>
              <% for (let i = 0; i < locals.head.length; i++) { %>
                <th>
                  <%= locals.head[i] %>
                  <span class="sortby" onclick="sortTable(<%= i %>, 'card-gallery-table')" id="<%= i %>">
                    <%- locals.orderSymbols[i] %>
                  </span>
                </th>
              <% } %>
              <th>Remove</th>
            </tr>
          </thead>
          <tbody>
            <!-- empty -->
          </tbody>
        </table>
      </div>
      <div>
        <label for="num-money">Add Money:</label>
        <input type="number" id="num-money" name="num-money" min="0" max="45" value="15">
        <button id="deck-export-button">Export Your Deck</button>

        <script type="module">
          import { exportDeckTxt } from '/js/exportCSV.js';
          document.getElementById("deck-export-button").addEventListener("click", ()=> exportDeckTxt('my-deck-table'));
        </script>
      </div>
    </div>
  </div>
</main>

<footer>
  <%- include('../partials/footer'); %>
</footer>

</body>
</html>